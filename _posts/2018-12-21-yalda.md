---
layout: post
image: yalda/yalda-min.png
title: شبِ چلّه؟!
fadate: 30 آذر 1397
tag: برنامه نویسی
---

الان که دارم اینو می­نویسم تقریبا نیمی از یلدا سپری شده و برخلاف تصمیمم نتونستم اونقدرها از تکنولوژی دور بمونم.

قصه از این قراره که خواستم شب یلدا رو بدون اینترنت و تکنولوژی سپری کنم (که نتونستم!) و فرستادن ایمیل تبریک به دوستام رو بسپارم به کامپیوتر (:

راه حل این بود که یک برنامه کوچیک واسه این کار بنویسم و بعد توی cron بذارمش تا توی ساعت مشخص، اجرا بشه.

برای ارسال ایمیل از SMTP استفاده میکنم که توی پایتون با ماژول smtplib خیلی راحت میشه باهاش کار کرد:

```python
import smtplib
```
و اینجوری روی پورت 587 بهش وصل میشم:

```python
server = SMTP('smtp.gmail.com', 587)
server.starttls()

username = 'ایمیل من'
password = 'پسوردم'

server.login(username, password)
```

خب، حالا یک پیام پیشفرض و یک دیکشنری از اسم و ایمیل دوستام درست میکنم تا توی ایمیل به هر کسی با اسمش تبریک بگم:

```python
msg = "یلدات مباااارک، {} عزیز!"

my_friends = {
'احسان': 'emailesh@harchi.harchi', 
'فاطمه زهرا': 'emailesh@harchi.harchi',
'محمد': 'emailesh@harchi.harchi',
'امیر': 'emailesh@harchi.harchi',
}
```

قدم آخر نوشتن یک حلقه ست که به تمام ایمیل های توی دیکشنری پیام بفرسته:

```python
for key in my_friends:
    # اسم دوستمون رو توی پیام جایگزین میکنیم
    this_msg = msg.format(key))
    # با یک حرکت میفرستیمش ((:
    server.sendmail(
     username, 
     my_friends[key], 
     msg.encode('utf-8')
     )
```

و خروجی برای هر کس، همچین چیزی خواهد بود:

```python
# یلدات مباااارک، احسان عزیز!
# یلدات مباااارک، فاطمه زهرا عزیز!
# یلدات مباااارک، محمد عزیز!
# یلدات مباااارک، امیر عزیز!
```

کافیه کد بالا رو توی کرون بذارم تا یک زمان مشخص اجرا بشه و پیام تبریک ها رو ارسال کنه.

**پی نوشت**: یلداتون مبارک (: